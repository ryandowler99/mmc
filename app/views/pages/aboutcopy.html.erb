
<style>
	.testclass{
	 background-color: yellow;
	}
	.body{
		background-color: #7b69eb;
	}
	.panel, .panel-default>.panel-heading{
		border-radius: 40px 40px 0px 0px;
	}
	.panel-default>.panel-heading{
		background: linear-gradient(-120deg, #021B79, #0575E6, #205E9B);
		opacity: .9;
	}
	.panel-body{
		background: linear-gradient(-9deg, rgba(46, 160, 226, 0.6), rgba(32, 151, 222, 0.8), rgba(32, 94, 155, 0.4));
	}
	.top-bar {
	  background: #666;
	  color: white;
	  padding: 10px;
	  position: relative;
	  overflow: hidden;
	  padding-right:5px;
	}
	.box-position{
		position: fixed;
		bottom: 0;
		width: 100%;
	}
	/* assistant */
		.assistantMenu{
			visibility: hidden;
		}
		#offsetImage{
			height: 50px;
			width: 50px;
		}
		.assistantQuestion{
			background: linear-gradient(100deg, rgba(255, 155, 46, 0.6), orange, rgba(255, 155, 46, 0.6));
			color: whitesmoke;
			font-size: 2em;
			font-weight: bold;
			text-align: center;
			text-transform: uppercase;
			border-radius: 8px;
		}
		
		/* buttons for assistant */
		.assistntButton {
		  padding-top: 30px;
		  padding-bottom: 30px;
		  text-align: center;
		  color: #000;
		  text-transform: uppercase;
		  font-weight: 600;
		  margin-left: 30px;
		  margin-bottom: 30px;
		  cursor: pointer;
		  display: inline-block;
		  font-size: 2em;
		}

		.button-3 {
		  border: 2px solid #fff;
		  background-color:  rgba(153, 189, 255, 0.3);
		  border-radius: 20px;
		  color: #fff;
		  transition: .3s;
		}
		.button-3:hover {
		  box-shadow: 8px 8px #0575E6; 
		  transition: .3s;
		  background-color: #205E9B;
		  font-size: 2.5em;
		  color: white;
		}
		.assYesBtn{color: green; }
		.assNoBtn{ color: orange; }
		
/* ./button for assistant */

.sidenav {
    width: 130px;
    position: fixed;
    z-index: 1;
    top: 250px;
    right: 10px;
    background: linear-gradient(142deg, rgba(46, 160, 226, 0.6), rgba(32, 151, 194, 0.8), rgba(32, 94, 155, 0.4));
    overflow-x: hidden;
    padding: 8px ;
	border-radius: 5px;
}
.clippy:active > .sidenav{
    background: #ccc
	border: 5px solid black;
}

/* assistant hint bubble */
.speech-bubble {
	position: relative;
	background: #00aabb;
	border-radius: .4em;
}
.speech-bubble:after {
	content: '';
	position: absolute;
	bottom: 0;
	left: 50%;
	width: 0;
	height: 0;
	border: 64px solid transparent;
	border-top-color: #00aabb;
	border-bottom: 0;
	border-left: 0;
	margin-left: -32px;
	margin-bottom: -64px;
}
.visHidden{ visibility: hidden; }

/* pulse animation */
.pulse {
  width: inherit;
  height: inherit;
  cursor: pointer;
  box-shadow: 0 0 0 rgba(43, 255, 237, 0.5);
  animation: pulse 1s infinite;
}
@-webkit-keyframes pulse {
  0% {
    -webkit-box-shadow: 0 0 0 0 rgba(204,169,44, 0.5);
  }
  70% {
      -webkit-box-shadow: 0 0 0 10px rgba(43, 255, 237, 0.5));
  }
  100% {
      -webkit-box-shadow: 0 0 0 0 rgba(43, 255, 237, 0.5);
  }
}
@keyframes pulse {
  0% {
    -moz-box-shadow: 0 0 0 0 rgba(43, 255, 237, 0.5);
    box-shadow: 0 0 0 0 rgba(43, 255, 237, 0.5);
  }
  70% {
      -moz-box-shadow: 0 0 0 10px rgba(43, 255, 237, 0.2);
      box-shadow: 0 0 0 10px rgba(43, 255, 237, 0.2);
  }
  100% {
      -moz-box-shadow: 0 0 0 0 rgba(204,169,44, 0);
      box-shadow: 0 0 0 0 rgba(43, 255, 237, 0.1);
  }
}
/* ./ pulse animation */
</style>
<h1>Pages#about</h1>
<p>Find me in app/views/pages/about.html.erb</p>
<br>
<br>
<br>
<br>
<br>
<br>
<p> heyyyyyyyy down here </p>


<div id="valuesBox" style="width: 250px; height: 100px; border: 2px solid purple; padding: 30px; position: fixed; right: 10; bottom:20;"> im a div after buttons </div>
<div id="valuesBox2" style="width: 250px; height: 100px; border: 2px solid lime; padding: 30px; position: fixed; right: 10; bottom:130;"> im a div after buttons </div>

<input id="theNewButton2" type="button"> new button2 </input>
<input id="theOtherButton" type="button"> theOtherButton wong </input>
<input id="boomButton" type="button"> boom btn </input>
<hgroup id="assistantBubbleHint" class="speech-bubble col-md-2 visHidden">
	<h2>CSS speech bubbles made easy!</h2>
</hgroup>
<script type="text/javascript">
	$( document ).ready(function() {

		var shortestDist = 10000;
		var closestElm = "---";
		var clickableElm = []; //holds clickable elements and their x & y pos 99 rename with s
		var count = 0; //
		
		//check for missed clicks
		$(document).click(function(event) { 
			//does have id - tell issue detection func to see if its an elm user should be clicking to complete task
			if (event.target.id){
				var id = event.target.id;
				var numOfErrorsAllowed = 1; //number of errors that will be tolerated before executing
				//$('#valuesBox').text("id: " + event.target.id + "  ");
				checkForIssues(id, numOfErrorsAllowed, true); //check if clicked elm is one of the needed elms to complete the task at hand (int, int, boolean)
			}
			//missed click - if the clicked elm has no id (must be a miss click)
			if (!event.target.id){
				$('#valuesBox').text("X: " + event.clientX + "  " + "Y:" + event.clientY);
				findClosestClickable(event.clientX, event.clientY); 
			}
		});


		function findClosestClickable(mouseX,mouseY){
			var clickableElms = getClickableItems(); //all page clickable elms 999 chnage to callback so executes in correct order
			//console.log("1: " + clickableElm[0].y);
			
			$.each(clickableElms , function (index, value){
				var x1 = clickableElm[index].x; //iterated elm x
				var y1 = clickableElm[index].y; //iterated elm y
				var elmId = clickableElm[index].id;
				var closestClickable = checkDist(elmId, x1,y1, mouseX, mouseY); //check distance beteen the mouse xy and the current clickable being iterated	
			    console.log(" CLOSEST element is " + closestClickable + " - with a distance of: " + shortestDist);
				$('#valuesBox2').text("closest elm is " + closestElm + " and it was this far away: " + shortestDist );
			});
			//do the callback list thoing so the funcs execute after the prev finnishes so the vals are def availible and stuff
			//reset array
			clickableElms.length = 0;
		}

		function getClickableItems(){
			//reset variables for next use
			shortestDist = 10000; 
			closestElm = "---"; //999 dont think i need because checkDist returns closestClickable

			$(":button").each(function() {
				var $this = $(this); // 999 visit this link to talk about why u put this here and to comment here too -> https://stackoverflow.com/questions/36722979/this-offset-is-not-a-function-within-a-click-function
				var pos = $this.offset(); //get position of elm (x,y)
				var theId = this.id.toString(); 
				//add clickable elem's id and position to the array
				clickableElm[clickableElm.length] = { id: theId, x: pos["left"], y: pos["top"]};
				if(clickableElm[0]){
					//console.log("obj is  -   " + clickableElm[count].id + " x: " + clickableElm[count].x + " y: " + clickableElm[count].y  + "        |       len  " + clickableElm.length + "  count: " + count);
					count ++;
				}
			});
			return clickableElm;
		}

		//check dist beteen clickable elms and mouse click position
		function checkDist(elmId, x1,y1, x2, y2){
			var xDist = x1 - x2;
			var yDist = y1 - y2;
			
			var currentDist; //current one being iterated
			var distance = Math.sqrt( xDist*xDist + yDist*yDist ); //distance (float) between mouse and elm
			currentDist = distance;
			
			if(currentDist < shortestDist){
				shortestDist = currentDist;
				closestElm = elmId;
			}
			//return distance;
			return closestElm;
		}
		/*  ./ Missed clicks */
			

		/*  Error/issue detection */
		//page variables 
		var taskElems = ['theNewButton2', 'boomButton']; //holds the elements that need to be interacted with to do the pages's task (create budget etc)
		var numOfErrorsSoFar = 0;
		var numOfOrderErrors = 0; //tracks the humber of times user clicks a correct elm but in wrong order (user given feedback on this)

		//(used by checkForIssues func). Place a bubble near a specified elemt with a specified message and coordinates (points to elem w/ bubble & makes it pulse)
		function elemPointerBubble(closestElm, closestElmPos, bubbleHeight, bubbleWidth, message){
			alert("your clicking the wrong elems - you must be lost, you first need to use: " + closestElm);
			var theMessage = message ? message : 'fallback message here that is generic';
			$("#assistantBubbleHint h2").text(theMessage)
				.parent().toggleClass('visHidden')
				.offset({ top: (closestElmPos['top'] - bubbleHeight*2 ),
							left: (closestElmPos['left'] - bubbleWidth*.3) });
			closestElm.toggleClass('pulse');
			//add event listener for btn 
			$(closestElm).click(function() {
				$(closestElm).unbind('click'); //remove event listener
				closestElm.toggleClass('pulse'); //stop pulsing 
				$("#assistantBubbleHint").toggleClass('visHidden'); //remove annotation bubble
			});	
		}
		//checks if the user is completing the main task of a screen (steps to create a budget etc)
		function checkForIssues(id, numOfErrorsAllowed, executeInOrder){ //int, int, boolean
			//stops code being ran after all task elems are used
			if(taskElems.length){
				//alert("recieved id: " + id + " and numOfErrorsAllowed = " + numOfErrorsAllowed);
				var ItemPosInArray = jQuery.inArray(id, taskElems); //give the pos (0 -> ..) of the elem IF its in there, otherwise it returns -1
				var closestElm = $('#'+ taskElems[0]);
				var closestElmPos = closestElm.offset(); // x & y
				var bubbleHeight = $('#assistantBubbleHint').height();
				var bubbleWidth = $('#assistantBubbleHint').width();
				var BubbleMessage = "default message to be changed";
				//clicked elem was a correct one (part of the task at hand)
				if(ItemPosInArray!== -1){
					//if order of execution is specified when callling func
					if(executeInOrder){
						//if its the correct elem (first in array)
						if(ItemPosInArray == 0){
							alert("Thats the one " + ItemPosInArray);
							taskElems.splice(ItemPosInArray, 1);
							$('#valuesBox').text("arry is: " + taskElems + "  ");
							numOfErrorsSoFar = 0; //reset error count after a sucessful click
						}
						//else - clicked elem was not the first one in array - so its noit the next to be clicked
						else{
							numOfOrderErrors++;
							alert("its in there alright " + ItemPosInArray + " but it needs to be clicked later. After this one at least: " + closestElm + " num of ordererro: " + numOfOrderErrors);
							$('#valuesBox').text("arry is still: " + taskElems + "  ");
						}
					//order doesnt matter	
					}else{
						//if the order does not matter
						alert(" order doesnt matter if statement - its in there alright " + ItemPosInArray);
						//taskElems.splice(ItemPosInArray, 1);
						//$('#valuesBox').text("arry is: " + taskElems + "  ");
						//numOfErrorsSoFar = 0; //reset error count after a sucessful click
					}
					//finally check the error count before providing a helper bubble
					if(numOfOrderErrors > numOfErrorsAllowed){
						numOfOrderErrors = 0;
						//make bubble apear near the corect elem and make that elem pulse visually
						elemPointerBubble(closestElm, closestElmPos, bubbleHeight, bubbleWidth, BubbleMessage);
					}

				//clicked elem was incorrect (NOT part of the task at hand)
				}else{
					$('#valuesBox').text("else arry is: " + taskElems + "  ");
					numOfErrorsSoFar ++; //record this error/issue
					alert("numOfErrorsSoFar" + numOfErrorsSoFar);
					
					//numOfErrorsAllowed instread of 1
					if(numOfErrorsSoFar > numOfErrorsAllowed){
						//make bubble apear near the corect elem and make that elem pulse visually
						elemPointerBubble(closestElm, closestElmPos, bubbleHeight, bubbleWidth, BubbleMessage);
					}
				}
			}
		}// checkForIssues func
	}); //doc ready
</script>